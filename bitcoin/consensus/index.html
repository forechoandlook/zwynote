<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>consensus - zwy notes</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "consensus";
        var mkdocs_page_input_path = "bitcoin/consensus.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> zwy notes
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">docs</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../guide/">使用指南</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../..">Index</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">healthy</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../healthy/behavior/">Behavior</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">cuda</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../cuda/cmd/">PTX/SASS指令快速指南</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../cuda/other/">Other</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../cuda/profile/">在命令行模式下查看CUDA程序性能</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../cuda/tilelang/">tilelang</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">algorithm</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../algorithm/merkle/">Merkle</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">daily</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../daily/0327/">0327</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../daily/0328/">0328</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../daily/0331/">0331</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../daily/0401/">0401</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">search</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../search/search_engine/">Search engine</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../search/spelling_correction/">Spelling correction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../search/theone_search_design/">简化版高效存储方案：平衡功能与复杂度</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../search/theone_search_design_impl/">常驻服务模式实现 (Python版本)</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">bitcoin</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basic/">Basic</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../norms/">Norms</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../problem/">Problem</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../story/">基本流程</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../theory/">Theory</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tps/">tps</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">train</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../train/unsloth/">Unsloth</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">cc</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../cc/cudac/">4090 的cuda特性</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../cc/mix/">Mix</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../cc/smart_point/">Smart point</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../cc/type_erasure/">Type erasure</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">bitcoin/nft</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../nft/qa/">Qa</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../nft/text_nft/">文本 nft</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../nft/text_nft_anti/">Text nft anti</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">zwy notes</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">consensus</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="consensus">consensus<a class="headerlink" href="#consensus" title="Permanent link">&para;</a></h1>
<p>共识算法是分布式系统中确保多个节点就某一状态或决策达成一致的机制，主要用于解决数据一致性、系统容错和协作问题。以下是主要共识算法及其特点、应用场景和局限性：</p>
<hr />
<h3 id="1-paxos"><strong>1. Paxos</strong><a class="headerlink" href="#1-paxos" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>目的</strong>：解决异步网络中节点故障下的共识问题，保证一致性。</li>
<li><strong>应用</strong>：分布式数据库（如Google Chubby）。</li>
<li><strong>原理</strong>：</li>
<li>分为提案（Propose）、承诺（Promise）、接受（Accept）阶段。</li>
<li>通过多数派（Quorum）确认达成一致。</li>
<li><strong>问题</strong>：</li>
<li>难以理解和实现。</li>
<li>活锁风险（提案冲突时可能无限重试）。</li>
</ul>
<hr />
<h3 id="2-raft"><strong>2. Raft</strong><a class="headerlink" href="#2-raft" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>目的</strong>：简化Paxos的理解与实现，提供强一致性。</li>
<li><strong>应用</strong>：Etcd、Consul、Kubernetes。</li>
<li><strong>原理</strong>：</li>
<li>领导者（Leader）选举 + 日志复制。</li>
<li>节点分为Leader、Follower、Candidate三种角色。</li>
<li><strong>问题</strong>：</li>
<li>依赖强领导者，故障时需重新选举。</li>
<li>网络分区可能导致脑裂（需额外解决）。</li>
</ul>
<hr />
<h3 id="3-pbft"><strong>3. PBFT（实用拜占庭容错）</strong><a class="headerlink" href="#3-pbft" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>目的</strong>：容忍拜占庭故障（节点恶意行为）。</li>
<li><strong>应用</strong>：联盟链（如Hyperledger Fabric）。</li>
<li><strong>原理</strong>：</li>
<li>三阶段协议（Pre-prepare、Prepare、Commit）。</li>
<li>需要至少 <span class="arithmatex">\(3f+1\)</span> 个节点容错 <span class="arithmatex">\(f\)</span> 个恶意节点。</li>
<li><strong>问题</strong>：</li>
<li>节点数多时通信开销大（<span class="arithmatex">\(O(n^2)\)</span>）。</li>
<li>仅适合小规模网络。</li>
</ul>
<hr />
<h3 id="4-pow"><strong>4. PoW（工作量证明）</strong><a class="headerlink" href="#4-pow" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>目的</strong>：开放网络中抗Sybil攻击（如公链）。</li>
<li><strong>应用</strong>：比特币、以太坊（1.0）。</li>
<li><strong>原理</strong>：</li>
<li>节点通过计算哈希竞争记账权。</li>
<li>最长链原则解决分叉。</li>
<li><strong>问题</strong>：</li>
<li>能源消耗巨大。</li>
<li>确认延迟高（比特币需6个区块确认）。</li>
</ul>
<hr />
<h3 id="5-pos"><strong>5. PoS（权益证明）</strong><a class="headerlink" href="#5-pos" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>目的</strong>：降低能耗，替代PoW。</li>
<li><strong>应用</strong>：以太坊2.0、Cardano。</li>
<li><strong>原理</strong>：</li>
<li>根据持币量和时间选择验证者。</li>
<li>分叉时通过"惩罚机制"抑制恶意行为。</li>
<li><strong>问题</strong>：</li>
<li>富人更富（马太效应）。</li>
<li>长程攻击风险（需额外防护）。</li>
</ul>
<hr />
<h3 id="6-dpos"><strong>6. DPoS（委托权益证明）</strong><a class="headerlink" href="#6-dpos" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>目的</strong>：进一步提升PoS效率。</li>
<li><strong>应用</strong>：EOS、TRON。</li>
<li><strong>原理</strong>：</li>
<li>持币者投票选出少数代表节点负责共识。</li>
<li><strong>问题</strong>：</li>
<li>中心化风险（权力集中在少数节点）。</li>
<li>选民参与度低可能导致腐败。</li>
</ul>
<hr />
<h3 id="7-gossip"><strong>7. Gossip协议</strong><a class="headerlink" href="#7-gossip" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>目的</strong>：最终一致性，高容错。</li>
<li><strong>应用</strong>：Cassandra、Redis Cluster。</li>
<li><strong>原理</strong>：</li>
<li>节点随机传播信息，最终全网同步。</li>
<li><strong>问题</strong>：</li>
<li>数据一致性是弱保证（可能临时不一致）。</li>
<li>传播延迟不确定。</li>
</ul>
<hr />
<h3 id="8-zabzookeeper-atomic-broadcast"><strong>8. ZAB（ZooKeeper Atomic Broadcast）</strong><a class="headerlink" href="#8-zabzookeeper-atomic-broadcast" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>目的</strong>：为ZooKeeper设计的崩溃容错共识。</li>
<li><strong>应用</strong>：Apache ZooKeeper。</li>
<li><strong>原理</strong>：</li>
<li>类似Raft，但优化了恢复流程。</li>
<li><strong>问题</strong>：</li>
<li>对领导者依赖强。</li>
</ul>
<hr />
<h3 id="9"><strong>9. 其他变种</strong><a class="headerlink" href="#9" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Tendermint</strong>：结合PBFT和PoS，用于Cosmos。</li>
<li><strong>HotStuff</strong>：Facebook Libra（Diem）使用，线性通信复杂度。</li>
</ul>
<hr />
<h3 id="_1"><strong>为什么需要共识算法？</strong><a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>容错</strong>：允许部分节点故障时系统仍可用。</li>
<li><strong>一致性</strong>：避免数据冲突（如分布式数据库）。</li>
<li><strong>去中心化</strong>：无单点控制（如区块链）。</li>
<li><strong>协作</strong>：多个节点对顺序或状态达成一致（如日志复制）。</li>
</ol>
<hr />
<h3 id="_2"><strong>共识算法的核心问题</strong><a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>CAP权衡</strong>：一致性（C）、可用性（A）、分区容错性（P）不可兼得。</li>
<li><strong>性能瓶颈</strong>：通信开销、延迟、吞吐量。</li>
<li><strong>安全假设</strong>：是否容忍拜占庭故障（恶意节点）。</li>
<li><strong>公平性</strong>：如PoW/PoS中的资源分配问题。</li>
</ul>
<p>不同场景需权衡这些因素选择合适的算法。例如，金融系统需要强一致性（PBFT），而公链更关注去中心化（PoW/PoS）。</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../javascripts/mathjax.js"></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
